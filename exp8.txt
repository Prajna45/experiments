import tensorflow as tf
from tensorflow.keras import Sequential
from tensorflow.keras.layers import Conv1D,Flatten,Dense,Dropout
from tensorflow.keras.optimizers import Adam 
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn import datasets,metrics 
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
cancerData = datasets.load_breast_cancer()
x=pd.DataFrame(data=cancerData.data,columns=cancerData.feature_names)
x.head()
y=cancerData.target
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.1,stratify=y)
scaler=StandardScaler()
x_train=scaler.fit_transform(x_train)
x_test=scaler.transform(x_test)
x_train=x_train.reshape(512,30,1)
x_test=x_test.reshape(57,30,1)
model=Sequential()
model.add(Conv1D(filters=16,kernel_size=2,activation='relu',input_shape=(30,1)))
model.add(Dropout(0.2))
model.add(Conv1D(32,2,activation='relu'))
model.add(Dropout(0.2))
model.add(Flatten())
model.add(Dense(32,activation='relu'))
model.add(Dropout(0.2))
model.add(Dense(1,activation='sigmoid'))
model.compile(optimizer=Adam(learning_rate=0.0001),loss='binary_crossentropy',metrics=['accuracy'])
history=model.fit(x_train,y_train,epochs=35,verbose=1,validation_data=(x_test,y_test))
%load_ext tensorboard
%tensorboard --logdir logs/fit
import matplotlib.pyplot as plt
plt.plot(history.history['accuracy'])
plt.plot(history.history['val_accuracy'])
plt.title('model accuracy')
plt.ylabel('accuracy')
plt.xlabel('epoch')
plt.show()
plt.plot(history.history['loss'])
plt.plot(history.history['val_loss'])
plt.title('model loss')
plt.ylabel('loss')
plt.xlabel('epoch')
plt.legend(['train','test'],loc='upper left')
plt.show()